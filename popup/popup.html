<!DOCTYPE html>
<html>
  <head>
    <title>PhishHooks</title>
    <meta charset="utf-8"/>
  </head>
  <body>
    <h1>PhishHooks</h1>
    <button id="detect-btn" onclick="handleDetectClick()">Detect</button>

    <pre id="content" style="white-space: pre-wrap;"></pre>

    <script type="text/javascript">

      const CLIENT_ID = "process.env.PHIShHOOKS_CLIENT_ID";
      const API_KEY = 'process.env.GMAIL_API_KEY';

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      const SCOPES = 'https://www.googleapis.com/auth/gmail.readonly';

      let tokenClient;
      let gapiInited = false;
      let gisInited = false;

      //button invisible until everything loads
      document.getElementById('detect-btn').style.visibility = 'hidden';

      //load google api
      function gapiLoaded() {
        gapi.load('client', initializeGapiClient);
      }

      //initialize google api client
      async function initGapiClient() {
        await gapi.client.init({
          apiKey: API_KEY,
        });
        gapiInited = true;
        maybeEnableButtons();
      }

      //callback after google identity servies are loaded
      function gisLoaded() {
        tokenClient = google.accounts.oauth2.initTokenClient({
          client_id: CLIENT_ID,
          scope: SCOPES,
          callback: '', // defined later
        });
        gisInited = true;
        maybeEnableButtons();
      }

      //enable button functionality after libraries are loaded.
      function maybeEnableButtons() {
        if (gisInited && gapiInited) {
          document.getElementById('detect-btn').style.visibility = 'visible';
        }
      }
      

    </script>
  </body>
</html>